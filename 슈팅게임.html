<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>슈팅몬스터</title>

    <style>
        #container {
            display: block;
            width: 800px;
            height: 800px;
            margin: 30px 50px;
            border: 1px solid #000;
        }

        #container>#shooter {
            display: inline;
            width: 150px;
            height: 30px;
            margin: 0;
            background-color: #333;
            border: 1px solid #333;
            border-radius: 10px;
        }

        #stagearea {
            width: 800px;
            height: 400px;
            border: 1px solid #000;
        }

        #stagearea>#target {
            width: 70px;
            height: 15px;
            margin: 0 auto;
            background-color: #5de;
            border: 1px solid #000;
            border-radius: 10px;
        }

        .missile {
            display: block;
            width: 0;
            height: 0;
            border-width: 10px;
            border-style: solid;
            border-color: transparent transparent blue transparent;
        }
    </style>

</head>

<body>
    <div id="container">
        <div id="stagearea">
            <div id="target"></div>
        </div>
        <div id="shooter"></div>
    </div>


    <script>
        const shooterEl = document.getElementById('shooter');
        shooterEl.style.position = 'absolute';
        shooterEl.style.top = '790px';
        shooterEl.style.left = '380px';

        //슈터를 좌우화살표로 움직이는 함수
        const moveShooter = function (event) {
            let left = parseInt(shooterEl.style.left);
            if (event.key === 'ArrowLeft') {
                shooterEl.style.left = (left - 10) + "px";
            }

            if (event.key === 'ArrowRight') {
                shooterEl.style.left = (left + 10) + "px";
            }

            if (left < 70) {
                shooterEl.style.left = 70 + "px";
            }

            if (left > 705) {
                shooterEl.style.left = 705 + "px";
            }
        };

        const creatShoot = (event) => {
            let left = parseInt(shooterEl.style.left);
            let top = parseInt(shooterEl.style.top);
            
            if (event.key === ' ') {
                let shoot = document.createElement('div');
                let shootTop = parseInt(shoot.style.top);
                shoot.setAttribute("class", "missile")
                document.querySelector('body').appendChild(shoot);
                shoot.style.position = 'absolute';
                shoot.style.left = (left + 65) + 'px';
                
                const move = (time) => {
                    let stamp = Math.min(time,2000);
                    let currentTime = time;
                    let passedtime = time = currentTime;
                    shoot.style.top = 770 - passedtime*0.1 + 'px';

                    animation = requestAnimationFrame(move);
                };

                move();

            }
        };


        window.addEventListener('keydown', moveShooter);
        window.addEventListener('keydown', creatShoot);

    </script>

</body>

</html>